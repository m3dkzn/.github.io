<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3D Print Studio | –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    :root {
      --primary: #58c86b;
      --secondary: #2cab6b;
      --accent: #9be7a8;
      --success: #58c86b;
      --error: #ff4757;
      --text: #f5f5f5;
      --text-muted: rgba(255,255,255,.78);
      --gray: #8b8b8b;
      --bg-0: #0f0f12;
      --bg-1: #17171b;
      --glass: rgba(23,23,27,.7);
      --glass-border: rgba(88,200,107,.25);
      --shadow: 0 12px 40px rgba(0,0,0,.4);
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial;
      background: var(--bg-0);
      color: var(--text);
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed; inset: 0;
      background:
        radial-gradient(60% 40% at 10% 20%, rgba(88,200,107,.18), transparent 70%),
        radial-gradient(50% 35% at 90% 15%, rgba(88,200,107,.12), transparent 70%),
        radial-gradient(65% 45% at 70% 85%, rgba(155,231,168,.10), transparent 70%);
      z-index: -2;
      pointer-events: none;
    }

    /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
    .navbar {
      position: fixed; inset-inline: 0; top: 0; z-index: 1000;
      background: rgba(20,20,26,.72);
      backdrop-filter: blur(14px);
      border-bottom: 1px solid var(--glass-border);
      padding: 16px 0;
      transition: background .25s ease, padding .25s ease;
    }
    .navbar.scrolled { background: rgba(10,10,12,.86); padding: 12px 0; }
    .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; position: relative; }
    .logo { font-weight: 800; font-size: 1.4rem; color: var(--text); text-decoration: none; }
    .menu-toggle { display: none; background: none; border: 0; color: var(--text); font-size: 1.6rem; cursor: pointer; padding: 8px; border-radius: 10px; }
    .menu-toggle:focus-visible { outline: 2px solid var(--primary); outline-offset: 4px; }
    .nav-menu { list-style: none; display: flex; gap: 20px; margin: 0; padding: 0; }
    .nav-link { color: var(--text); text-decoration: none; padding: 10px 14px; border-radius: 12px; font-weight: 500; }
    .nav-link:hover { background: rgba(255,255,255,.06); color: var(--primary); }

    /* Hero */
    .hero { min-height: 40svh; display: grid; place-items: center; text-align: center; padding: 0 20px; }
    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 900; line-height: 1.08;
      background: linear-gradient(135deg, var(--text), var(--accent));
      -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
    }
    .hero p { max-width: 800px; margin: 14px auto 28px; color: var(--text-muted); font-size: clamp(1rem, 2.2vw, 1.2rem); }
    .cta-button { 
      display: inline-block; padding: 12px 20px; border-radius: 999px; 
      background: linear-gradient(135deg, var(--primary), var(--secondary)); 
      color: #06140a; text-decoration: none; font-weight: 700; 
      box-shadow: var(--shadow); border: none; cursor: pointer;
    }
    .cta-button:hover { transform: translateY(-1px); }

    /* –ö–æ–Ω—Ç–µ–Ω—Ç */
    .main-content { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .portfolio-section { display: grid; grid-template-columns: 380px 1fr; gap: 36px; margin: 80px 0 100px; align-items: start; }
    .glass-card { 
      background: var(--glass); border: 1px solid var(--glass-border); 
      border-radius: 16px; padding: 28px; backdrop-filter: blur(12px); 
      box-shadow: var(--shadow); transition: transform .25s ease, border-color .25s ease;
    }
    .glass-card:hover { transform: translateY(-4px); border-color: var(--primary); }
    .photo-card { position: sticky; top: 96px; text-align: center; }
   .photo-placeholder {
 height: 357px;
 border-radius: 12px;
 background: linear-gradient(135deg, #222, #1a1a1f);
 display: grid;
 place-items: center;
 color: var(--primary);
 margin-bottom: 16px;
 overflow: hidden;
}

.photo {
 max-width: 100%;
 max-height: 100%;
 width: auto;
 height: auto;
 object-fit: cover;
 object-position: 50% 20%; /* –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–¥–≤–∏–≥–∞ –≤–≤–µ—Ä—Ö */
 border-radius: 12px;
}
    .biography-title { font-size: clamp(1.8rem, 3.5vw, 2.2rem); margin-bottom: 16px; color: var(--primary); }
    .biography-text { font-size: clamp(0.8rem, 2.3vw, 1.3rem); color: var(--text-muted); line-height: 1.7; margin-bottom: 14px; }
    
    .section-header { text-align: center; margin-bottom: 36px; }
    .section-title { font-size: clamp(1.8rem, 4vw, 2.6rem); font-weight: 900; background: linear-gradient(135deg, var(--text), var(--accent)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
    
    .projects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 24px; margin-bottom: 64px; }
    .project-card { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 18px; overflow: hidden; cursor: pointer; transition: transform .25s ease, border-color .25s ease; }
    .project-card:hover { transform: translateY(-6px); border-color: var(--primary); box-shadow: var(--shadow); }
    .project-image { aspect-ratio: 4 / 3; width: 100%; background: linear-gradient(135deg, #26262b, #1a1a1f); display: flex; align-items: center; justify-content: center; color: var(--primary); overflow: hidden; }
    .project-image img { width: 100%; height: 100%; object-fit: contain; }
    .project-content { padding: 20px; }
    .project-name { margin: 0 0 8px; color: var(--primary); font-size: 1.25rem; font-weight: 700; }
    .project-description { color: var(--text-muted); margin-bottom: 10px; }
    .project-price { color: #a6f3b3; font-weight: 800; }

    .pricing-section { margin: 80px 0; padding: 40px; border-radius: 20px; background: var(--glass); border: 1px solid var(--glass-border); box-shadow: var(--shadow); }
    .pricing-header { text-align: center; margin-bottom: 30px; }
    .pricing-title { margin: 0; font-size: clamp(1.8rem, 4vw, 2.6rem); font-weight: 900; color: var(--primary); }
    .pricing-subtitle { margin-top: 12px; color: var(--text-muted); }
    .pricing-grid { display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
    .price-card { background: rgba(15, 15, 18, 0.85); border: 1px solid var(--glass-border); border-radius: 16px; padding: 24px; position: relative; transition: transform .25s ease, border-color .25s ease; }
    .price-card:hover { transform: translateY(-4px); border-color: var(--primary); }
    .price-card h3 { margin: 0 0 8px; color: var(--text); font-size: 1.2rem; }
    .price-card p { margin: 0 0 12px; color: var(--text-muted); }
    .price-row { display: flex; align-items: baseline; gap: 6px; }
    .price-value { font-size: 1.6rem; font-weight: 800; color: #a6f3b3; }
    .price-unit { font-size: 0.85rem; color: var(--gray); }

    /* –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ */
    .project-modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.85); backdrop-filter: blur(6px); z-index: 2000; padding: 16px; }
    .project-modal.show { display: flex; }
    .modal-content { width: min(1100px, 100%); max-height: 92svh; border-radius: 18px; overflow: hidden; background: var(--bg-1); border: 1px solid var(--glass-border); box-shadow: var(--shadow); }
    .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 18px 20px; border-bottom: 1px solid var(--glass-border); background: rgba(0,0,0,.25); }
    .modal-title { margin: 0; font-size: 1.4rem; }
    .close-btn { width: 44px; height: 44px; border-radius: 50%; border: 0; background: transparent; color: var(--gray); font-size: 24px; cursor: pointer; }
    .close-btn:hover { background: rgba(255,255,255,.06); color: var(--text); }
    .modal-body { display: grid; grid-template-columns: 2fr 1fr; min-height: 480px; }
    .modal-left { background: #131317; position: relative; }
    .modal-image { position: absolute; inset: 0; background: #222; display: flex; align-items: center; justify-content: center; color: var(--primary); overflow: hidden; padding: 12px; }
    .modal-image img { max-width: 100%; max-height: 100%; object-fit: contain; }
    .modal-image.empty { color: var(--primary); font-size: 1rem; text-align: center; }
    .image-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,.6); color: #fff; border: 0; width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 18px; display: none; align-items: center; justify-content: center; }
    .image-nav:hover { background: var(--primary); color: #06140a; }
    .prev-btn { left: 12px; }
    .next-btn { right: 12px; }
    .image-counter { position: absolute; top: 12px; right: 12px; background: rgba(0,0,0,.6); color: #fff; padding: 6px 10px; border-radius: 999px; font-size: 12px; }
    .modal-right { background: #101014; display: flex; flex-direction: column; }
    .modal-content-section { padding: 20px; flex: 1; overflow: auto; }
    .project-detail-title { margin: 0 0 10px; color: var(--primary); }
    .project-detail-description { color: var(--text-muted); line-height: 1.7; }
    .modal-price-section { padding: 16px 20px; border-top: 1px solid var(--glass-border); background: rgba(0,0,0,.25); text-align: center; }
    .price-label { color: var(--gray); font-size: .95rem; }
    .price-value { font-size: 2rem; font-weight: 900; color: #a6f3b3; }

    /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
    .admin-panel {
      position: fixed;
      top: 0;
      right: -550px;
      width: 550px;
      height: 100vh;
      background: var(--bg-1);
      backdrop-filter: blur(30px);
      z-index: 3000;
      transition: right 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-left: 1px solid var(--glass-border);
      overflow-y: auto;
      box-shadow: -10px 0 30px rgba(0,0,0,0.5);
      display: none;
    }
    .admin-panel.active { right: 0; display: block; }
    
    .admin-header {
      padding: 30px;
      background: var(--bg-0);
      border-bottom: 1px solid var(--glass-border);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .admin-title { font-size: 2rem; color: var(--primary); margin-bottom: 10px; font-weight: 700; }
    .close-admin {
      position: absolute;
      top: 25px;
      right: 25px;
      background: none;
      border: none;
      color: var(--primary);
      font-size: 24px;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.3s ease;
      width: 40px;
      height: 40px;
    }
    .close-admin:hover { background: var(--error); color: var(--text); transform: rotate(90deg); }
    
    .admin-content { padding: 30px; }
    .admin-nav { display: flex; gap: 10px; margin-bottom: 24px; }
    .admin-nav-btn {
      flex: 1;
      background: rgba(255,255,255,0.05);
      border: 1px solid transparent;
      padding: 14px 18px;
      color: var(--text-muted);
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .admin-nav-btn.active {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: var(--bg-0);
      border-color: rgba(255,255,255,0.08);
      box-shadow: 0 10px 25px rgba(88, 200, 107, 0.25);
    }
    .admin-pane { display: none; }
    .admin-pane.active { display: block; }
    .project-tabs {
      display: flex;
      margin-bottom: 30px;
      border-radius: 12px;
      background: var(--glass);
      padding: 4px;
    }
    .project-tab {
      flex: 1;
      background: none;
      border: none;
      padding: 12px 20px;
      color: var(--gray);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    .project-tab.active { background: var(--primary); color: var(--bg-0); }
    
    .project-tab-content { display: none; }
    .project-tab-content.active { display: block; }
    
    .form-group { margin-bottom: 25px; }
    .form-label { display: block; color: var(--primary); margin-bottom: 8px; font-weight: 600; }
    .form-input, .form-textarea {
      width: 100%;
      padding: 15px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text);
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .form-input:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 0 3px rgba(88, 200, 107, 0.1);
    }
    .form-textarea { resize: vertical; min-height: 120px; }
    
    .image-upload-area {
      border: 2px dashed var(--glass-border);
      border-radius: 12px;
      padding: 40px 20px;
      text-align: center;
      background: var(--glass);
      transition: all 0.3s ease;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .image-upload-area.dragover { border-color: var(--primary); background: rgba(88, 200, 107, 0.1); }
    .upload-text { color: var(--gray); font-size: 16px; margin-bottom: 10px; }
    
    .uploaded-images {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .uploaded-image { position: relative; border-radius: 8px; overflow: hidden; background: var(--glass); aspect-ratio: 1; }
    .uploaded-image img { width: 100%; height: 100%; object-fit: cover; }
    .remove-image { position: absolute; top: 5px; right: 5px; background: var(--error); color: var(--text); border: none; width: 24px; height: 24px; border-radius: 50%; cursor: pointer; font-size: 14px; display: grid; place-items: center; }
    .reorder-group { position: absolute; left: 5px; bottom: 5px; display: flex; gap: 4px; }
    .reorder-image { background: rgba(0,0,0,0.6); color: #fff; border: none; width: 24px; height: 24px; border-radius: 6px; cursor: pointer; font-size: 16px; display: grid; place-items: center; }
    .reorder-image:hover { background: var(--primary); color: var(--bg-0); }
    
    .btn { padding: 15px 30px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
    .btn-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: var(--bg-0); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(88, 200, 107, 0.3); }
    .btn-success { background: var(--success); color: var(--bg-0); padding: 8px 16px; font-size: 14px; }
    .btn-danger { background: var(--error); color: var(--text); padding: 8px 16px; font-size: 14px; }
    .btn-danger:hover { background: #ff3742; transform: scale(1.05); }
    
    .project-list { display: grid; gap: 20px; }
    .project-item { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 16px; padding: 25px; transition: all 0.3s ease; }
    .project-item:hover { border-color: var(--primary); transform: translateX(5px); }
    .project-item h4 { color: var(--primary); margin-bottom: 10px; font-size: 1.2rem; }
    .project-item p { color: var(--text-muted); margin-bottom: 15px; line-height: 1.5; }
    .project-actions { display: flex; gap: 10px; margin-top: 15px; }
    .price-admin { display: grid; gap: 24px; }
    .price-list-items { display: grid; gap: 16px; }
    .price-list-item { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 14px; padding: 18px; display: grid; gap: 12px; }
    .price-list-item header { display: flex; justify-content: space-between; align-items: center; gap: 12px; }
    .price-list-item h4 { margin: 0; color: var(--primary); }
    .price-controls { display: flex; gap: 10px; flex-wrap: wrap; }
    .price-controls button { padding: 8px 14px; border-radius: 10px; border: none; cursor: pointer; font-size: 0.85rem; }
    .btn-light { background: rgba(255,255,255,0.08); color: var(--text); }
    .btn-light:hover { background: rgba(88,200,107,0.2); }
    .sync-status { margin-top: 12px; font-size: 0.9rem; color: var(--gray); display: inline-flex; align-items: center; gap: 6px; }
    .sync-status::before { content: '‚óè'; font-size: 0.6rem; }
    .sync-status[data-state="ok"] { color: #a6f3b3; }
    .sync-status[data-state="ok"]::before { color: #58c86b; }
    .sync-status[data-state="error"] { color: var(--error); }
    .sync-status[data-state="error"]::before { color: var(--error); }
    .sync-status[data-state="pending"]::before { color: #f0d264; }
    .admin-settings { margin: 20px 0 30px; padding: 20px; border: 1px dashed var(--glass-border); border-radius: 14px; background: rgba(23, 23, 27, 0.6); }
    .admin-settings h3 { margin: 0 0 12px; color: var(--primary); font-size: 1.2rem; }
    .admin-settings p { margin: 0 0 12px; color: var(--text-muted); font-size: 0.9rem; }
    .settings-actions { display: flex; flex-wrap: wrap; gap: 10px; }
    .btn-secondary { background: rgba(255, 255, 255, 0.12); color: var(--text); padding: 10px 18px; font-size: 14px; border: 1px solid var(--glass-border); border-radius: 10px; cursor: pointer; transition: all 0.3s ease; }
    .btn-secondary:hover { background: rgba(88, 200, 107, 0.2); border-color: var(--primary); }
    .form-hint { margin-top: 6px; color: var(--gray); font-size: 0.85rem; }

    /* –ö–æ–Ω—Ç–∞–∫—Ç—ã */
    .contacts-section { text-align: center; margin: 20px 0 80px; }
    .contact-info { font-size: 1.05rem; color: var(--text-muted); line-height: 1.8; }

    /* –°–æ–æ–±—â–µ–Ω–∏—è */
    .message { position: fixed; top: 90px; right: 24px; padding: 12px 16px; border-radius: 12px; font-weight: 700; transform: translateX(340px); transition: transform .3s ease; z-index: 5000; }
    .message.show { transform: translateX(0); }
    .message.success { background: #a6f3b3; color: #062312; }
    .message.error { background: var(--error); color: #fff; }

    @media (max-width: 1024px) {
      .portfolio-section { grid-template-columns: 1fr; }
      .photo-card { position: static; }
    }
    @media (max-width: 768px) {
      .menu-toggle { display: block; }
      .nav-menu { position: absolute; top: 72px; right: 16px; flex-direction: column; gap: 10px; background: rgba(15,15,18,.95); border: 1px solid var(--glass-border); border-radius: 16px; padding: 16px; width: min(240px, 90vw); box-shadow: var(--shadow); display: none; }
      .nav-menu.open { display: flex; }
      .nav-link { display: block; }
      .modal-body { grid-template-columns: 1fr; }
      .projects-grid { grid-template-columns: 1fr; }
      .pricing-section { padding: 28px 18px; }
      .admin-panel { width: 100%; right: -100%; }
      .admin-nav { flex-direction: column; }
      .admin-nav-btn { width: 100%; }
      .image-nav { display: none !important; }
    }
  </style>
</head>
<body>
  <nav class="navbar" id="navbar">
    <div class="nav-container">
      <a href="#home" class="logo">M3D KZN</a>
      <button class="menu-toggle" id="menuToggle" aria-label="–ú–µ–Ω—é">‚ò∞</button>
      <ul class="nav-menu" id="navMenu">
        <li><a class="nav-link" href="#home">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a class="nav-link" href="#portfolio">–û–±–æ –º–Ω–µ</a></li>
        <li><a class="nav-link" href="#projects">–ü—Ä–æ–µ–∫—Ç—ã</a></li>
        <li><a class="nav-link" href="#pricing">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç</a></li>
        <li><a class="nav-link" href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </div>
  </nav>

  <section id="home" class="hero">
    <div class="hero-content">
      <h1>–ü–û–†–¢–§–û–õ–ò–û –°–ü–ï–¶–ò–ê–õ–ò–°–¢–ê –í –°–§–ï–†–ï –ê–î–î–ò–¢–ò–í–ù–´–• –¢–ï–•–ù–û–õ–û–ì–ò–ô</h1>
      <p></p>
      <a href="#projects" class="cta-button">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–µ–∫—Ç—ã</a>
    </div>
  </section>

  <main class="main-content">
    <section id="portfolio" class="portfolio-section">
      <div class="glass-card photo-card">
<div class="photo-placeholder">
 <img 
 src="https://sun9-84.userapi.com/s/v1/ig2/FZS6f7unVWz60WbtLfrole1Cx46VjdyctJw1wxwj_xvJAsekLu0QIUriZ6g-R5ovmqKDS29hoUee_XIYZ1BzHntI.jpg?quality=95&as=32x43,48x64,72x96,108x144,160x214,240x321,360x481,480x641,540x721,640x855,720x962,1080x1443,1280x1710,1440x1924,1916x2560&from=bu&cs=1916x0" 

 class="photo" >
</div>

        <h2 style="margin:0;color:var(--primary)"></h2>
      </div>
      <div class="glass-card">
        <h2 class="biography-title"></h2>
        <p class="biography-text">–ü—Ä–∏–≤e—Ç—Å—Ç–≤—É—é, —É–≤a–∂a–µ–º—ã–µ –≥–æ—Å—Ç–∏ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ. M–µ–Ω—è –∑o–≤—É—Ç –ú–∏xa–∏–ª. –üpe–¥oc—Ça–≤–ª—è—é —Éc–ª—É–≥–∏ 3–î-–øe—áa—Ç–∏ –∏ –≤c–µ —Å–æ–ø—É—Çc—Ç–≤—É—é—â–∏e —É—Å–ª—É–≥–∏ –≤ c—Ñ–µpe a–¥–¥–∏—Ç–∏–≤–Ω—ãx —Çex–Ωo–ªo–≥–∏–π –øo –≥–æ—Äo–¥—É –ö–∞–∑a–Ω—å.</p>
        <p class="biography-text">–ù–∞ –¥–∞–Ω–Ω–æ–º —Å–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —è –≤—ã—Å—Ç—É–ø–∞–ª –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.</p>
      </div>
    </section>

    <section id="projects">
      <div class="section-header"><h2 class="section-title">–ú–û–ò –ü–†–û–ï–ö–¢–´</h2></div>
      <div class="projects-grid" id="projectsGrid"></div>
    </section>

    <section id="pricing" class="pricing-section">
      <div class="pricing-header">
        <h2 class="pricing-title">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç</h2>
        <p class="pricing-subtitle">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å 3D-–ø–µ—á–∞—Ç–∏</p>
      </div>
      <div class="pricing-grid" id="pricingGrid"></div>
    </section>

    <section id="contacts" class="contacts-section glass-card">
      <h2 class="section-title" style="-webkit-text-fill-color:unset;color:var(--text)">–°–í–Ø–ó–¨ –°–û –ú–ù–û–ô</h2>
      <div class="contact-info">
<p>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M16.1007 13.359L15.5719 12.8272H15.5719L16.1007 13.359ZM16.5562 12.9062L17.085 13.438H17.085L16.5562 12.9062ZM18.9728 12.5894L18.6146 13.2483L18.9728 12.5894ZM20.8833 13.628L20.5251 14.2869L20.8833 13.628ZM21.4217 16.883L21.9505 17.4148L21.4217 16.883ZM20.0011 18.2954L19.4723 17.7636L20.0011 18.2954ZM18.6763 18.9651L18.7459 19.7119H18.7459L18.6763 18.9651ZM8.81536 14.7266L9.34418 14.1947L8.81536 14.7266ZM4.00289 5.74561L3.2541 5.78816L3.2541 5.78816L4.00289 5.74561ZM10.4775 7.19738L11.0063 7.72922H11.0063L10.4775 7.19738ZM10.6342 4.54348L11.2346 4.09401L10.6342 4.54348ZM9.37326 2.85908L8.77286 3.30855V3.30855L9.37326 2.85908ZM6.26145 2.57483L6.79027 3.10667H6.79027L6.26145 2.57483ZM4.69185 4.13552L4.16303 3.60368H4.16303L4.69185 4.13552ZM12.0631 11.4972L12.5919 10.9654L12.0631 11.4972ZM16.6295 13.8909L17.085 13.438L16.0273 12.3743L15.5719 12.8272L16.6295 13.8909ZM18.6146 13.2483L20.5251 14.2869L21.2415 12.9691L19.331 11.9305L18.6146 13.2483ZM20.8929 16.3511L19.4723 17.7636L20.5299 18.8273L21.9505 17.4148L20.8929 16.3511ZM18.6067 18.2184C17.1568 18.3535 13.4056 18.2331 9.34418 14.1947L8.28654 15.2584C12.7186 19.6653 16.9369 19.8805 18.7459 19.7119L18.6067 18.2184ZM9.34418 14.1947C5.4728 10.3453 4.83151 7.10765 4.75168 5.70305L3.2541 5.78816C3.35456 7.55599 4.14863 11.144 8.28654 15.2584L9.34418 14.1947ZM10.7195 8.01441L11.0063 7.72922L9.9487 6.66555L9.66189 6.95073L10.7195 8.01441ZM11.2346 4.09401L9.97365 2.40961L8.77286 3.30855L10.0338 4.99296L11.2346 4.09401ZM5.73263 2.04299L4.16303 3.60368L5.22067 4.66736L6.79027 3.10667L5.73263 2.04299ZM10.1907 7.48257C9.66189 6.95073 9.66117 6.95144 9.66045 6.95216C9.66021 6.9524 9.65949 6.95313 9.659 6.95362C9.65802 6.95461 9.65702 6.95561 9.65601 6.95664C9.65398 6.95871 9.65188 6.96086 9.64972 6.9631C9.64539 6.96759 9.64081 6.97245 9.63599 6.97769C9.62634 6.98816 9.61575 7.00014 9.60441 7.01367C9.58174 7.04072 9.55605 7.07403 9.52905 7.11388C9.47492 7.19377 9.41594 7.2994 9.36589 7.43224C9.26376 7.70329 9.20901 8.0606 9.27765 8.50305C9.41189 9.36833 10.0078 10.5113 11.5343 12.0291L12.5919 10.9654C11.1634 9.54499 10.8231 8.68059 10.7599 8.27309C10.7298 8.07916 10.761 7.98371 10.7696 7.96111C10.7748 7.94713 10.7773 7.9457 10.7709 7.95525C10.7677 7.95992 10.7624 7.96723 10.7541 7.97708C10.75 7.98201 10.7451 7.98759 10.7394 7.99381C10.7365 7.99692 10.7335 8.00019 10.7301 8.00362C10.7285 8.00534 10.7268 8.00709 10.725 8.00889C10.7241 8.00979 10.7232 8.0107 10.7223 8.01162C10.7219 8.01208 10.7212 8.01278 10.7209 8.01301C10.7202 8.01371 10.7195 8.01441 10.1907 7.48257ZM11.5343 12.0291C13.0613 13.5474 14.2096 14.1383 15.0763 14.2713C15.5192 14.3392 15.8763 14.285 16.1472 14.1841C16.28 14.1346 16.3858 14.0763 16.4658 14.0227C16.5058 13.9959 16.5392 13.9704 16.5663 13.9479C16.5799 13.9367 16.5919 13.9262 16.6024 13.9166C16.6077 13.9118 16.6126 13.9073 16.6171 13.903C16.6194 13.9008 16.6215 13.8987 16.6236 13.8967C16.6246 13.8957 16.6256 13.8947 16.6266 13.8937C16.6271 13.8932 16.6279 13.8925 16.6281 13.8923C16.6288 13.8916 16.6295 13.8909 16.1007 13.359C15.5719 12.8272 15.5726 12.8265 15.5733 12.8258C15.5735 12.8256 15.5742 12.8249 15.5747 12.8244C15.5756 12.8235 15.5765 12.8226 15.5774 12.8217C15.5793 12.82 15.581 12.8183 15.5827 12.8166C15.5862 12.8133 15.5895 12.8103 15.5926 12.8074C15.5988 12.8018 15.6044 12.7969 15.6094 12.7929C15.6192 12.7847 15.6265 12.7795 15.631 12.7764C15.6403 12.7702 15.6384 12.773 15.6236 12.7785C15.5991 12.7876 15.501 12.8189 15.3038 12.7886C14.8905 12.7253 14.02 12.3853 12.5919 10.9654L11.5343 12.0291ZM9.97365 2.40961C8.95434 1.04802 6.94996 0.83257 5.73263 2.04299L6.79027 3.10667C7.32195 2.578 8.26623 2.63181 8.77286 3.30855L9.97365 2.40961ZM4.75168 5.70305C4.73201 5.35694 4.89075 4.9954 5.22067 4.66736L4.16303 3.60368C3.62571 4.13795 3.20329 4.89425 3.2541 5.78816L4.75168 5.70305ZM19.4723 17.7636C19.1975 18.0369 18.9029 18.1908 18.6067 18.2184L18.7459 19.7119C19.4805 19.6434 20.0824 19.2723 20.5299 18.8273L19.4723 17.7636ZM11.0063 7.72922C11.9908 6.7503 12.064 5.2019 11.2346 4.09401L10.0338 4.99295C10.4373 5.53193 10.3773 6.23938 9.9487 6.66555L11.0063 7.72922ZM20.5251 14.2869C21.3429 14.7315 21.4703 15.7769 20.8929 16.3511L21.9505 17.4148C23.2908 16.0821 22.8775 13.8584 21.2415 12.9691L20.5251 14.2869ZM17.085 13.438C17.469 13.0562 18.0871 12.9616 18.6146 13.2483L19.331 11.9305C18.2474 11.3414 16.9026 11.5041 16.0273 12.3743L17.085 13.438Z" fill="#FFFFFF"/>
</svg>

  <span>+7 922 891 3661</span>
</p>


		
<p>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M23.91 3.79L20.3 20.84c-.25 1.21-.98 1.5-2 .94l-5.5-4.07-2.66 2.57c-.3.3-.55.56-1.1.56-.72 0-.6-.27-.84-.95L6.3 13.7l-5.45-1.7c-1.18-.35-1.19-1.16.26-1.75l21.26-8.2c.97-.43 1.9.24 1.53 1.73z"></path>
  </svg> @sinisterfate
</p>


        <p>		<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

		<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 8L8.44992 11.6333C9.73295 12.4886 10.3745 12.9163 11.0678 13.0825C11.6806 13.2293 12.3194 13.2293 12.9322 13.0825C13.6255 12.9163 14.2671 12.4886 15.5501 11.6333L21 8M6.2 19H17.8C18.9201 19 19.4802 19 19.908 18.782C20.2843 18.5903 20.5903 18.2843 20.782 17.908C21 17.4802 21 16.9201 21 15.8V8.2C21 7.0799 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V15.8C3 16.9201 3 17.4802 3.21799 17.908C3.40973 18.2843 3.71569 18.5903 4.09202 18.782C4.51984 19 5.07989 19 6.2 19Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
		 <span> <a href="mailto:m3dkzn@gmail.com" style="color: white;">m3dkzn@gmail.com</a></p></span>
        <p>
		<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
		<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M19 10C19 13.9765 12 21 12 21C12 21 5 13.9765 5 10C5 6.02355 8.13401 3 12 3C15.866 3 19 6.02355 19 10Z" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path><circle cx="12" cy="10" r="3" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></circle></g></svg> <span> –ö–∞–∑–∞–Ω—å</span></p>
      </div>
    </section>
  </main>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ -->
  <div class="project-modal" id="projectModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">–ù–ê–ó–í–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê</h2>
        <button class="close-btn" onclick="closeProject()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="modal-left">
          <div class="modal-image" id="modalImage">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
          <button class="image-nav prev-btn" id="prevBtn" onclick="prevImage()">‚Äπ</button>
          <button class="image-nav next-btn" id="nextBtn" onclick="nextImage()">‚Ä∫</button>
          <div class="image-counter" id="imageCounter">1 / 1</div>
        </div>
        <div class="modal-right">
          <div class="modal-content-section">
            <h3 class="project-detail-title">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h3>
            <p class="project-detail-description" id="modalDescription">–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è‚Ä¶</p>
          </div>
          <div class="modal-price-section">
            <div class="price-label">–°–¢–û–ò–ú–û–°–¢–¨</div>
            <div class="price-value"><span id="projectPrice">0</span> ‚ÇΩ</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–∏–∑ (3), –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ —Å—Ç–∏–ª–∏ (2)) -->
  <div class="project-modal" id="authModal" style="display:none">
    <div class="modal-content" style="max-width:480px">
      <div class="modal-header">
        <h2 class="modal-title">üîí –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
        <button class="close-btn" onclick="closeAuth()">√ó</button>
      </div>
      <div class="modal-body" style="display:block;padding:20px">
        <p style="color:var(--text-muted);margin:0 0 12px">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</p>
        <input type="password" id="adminPassword" placeholder="–ü–∞—Ä–æ–ª—å" style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--glass-border);background:var(--glass);color:var(--text)" />
        <div style="display:flex;gap:10px;margin-top:14px">
          <button class="cta-button" onclick="checkPassword()">–í–æ–π—Ç–∏</button>
          <button class="btn-danger" onclick="closeAuth()">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–∏–∑ (3), —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ (2)) -->
  <div class="admin-panel" id="adminPanel">
    <div class="admin-header">
      <h2 class="admin-title">üõ†Ô∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
      <button class="close-admin" onclick="closeAdmin()">√ó</button>
    </div>
    <div class="admin-content">
      <div class="admin-nav">
        <button class="admin-nav-btn active" onclick="switchAdminPane('projects')" id="adminTabProjects">–ü—Ä–æ–µ–∫—Ç—ã</button>
        <button class="admin-nav-btn" onclick="switchAdminPane('pricing')" id="adminTabPricing">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç</button>
        <button class="admin-nav-btn" onclick="switchAdminPane('settings')" id="adminTabSettings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      </div>

      <div class="admin-pane active" id="projectsPane">
        <div class="project-tabs">
          <button class="project-tab active" onclick="switchProjectTab('add')" id="projectTabAdd">–î–æ–±–∞–≤–∏—Ç—å</button>
          <button class="project-tab" onclick="switchProjectTab('manage')" id="projectTabManage">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
        </div>

        <div id="addTab" class="project-tab-content active">
          <form onsubmit="saveProject(event)" id="projectForm">
            <input type="hidden" id="editingId" value="">
            <div class="form-group">
              <label class="form-label">üìù –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
              <input type="text" class="form-input" id="projectName" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞">
            </div>
            <div class="form-group">
              <label class="form-label">üìã –û–ø–∏—Å–∞–Ω–∏–µ</label>
              <textarea class="form-textarea" id="projectDescription" required placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –º–∞—Ç–µ—Ä–∏–∞–ª—ã‚Ä¶"></textarea>
            </div>
            <div class="form-group">
              <label class="form-label">üí∞ –¶–µ–Ω–∞ (‚ÇΩ)</label>
              <input type="number" class="form-input" id="projectPriceInput" min="0" required placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å">
            </div>
            <div class="form-group">
              <label class="form-label">üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞</label>
              <div class="image-upload-area" id="imageUploadArea">
                <div class="upload-text">üì§ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
                <input type="file" id="imageInput" multiple accept="image/*" style="display: none;">
              </div>
              <div class="uploaded-images" id="uploadedImages"></div>
            </div>
            <div style="display:flex; gap:12px; flex-wrap: wrap;">
              <button type="submit" class="btn btn-primary" id="saveBtn">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
              <button type="button" class="btn btn-danger" onclick="cancelEdit()" id="cancelBtn" style="display:none;">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
          </form>
        </div>

        <div id="manageTab" class="project-tab-content">
          <div class="project-list" id="projectList"></div>
        </div>
      </div>

      <div class="admin-pane" id="pricingPane">
        <div class="price-admin">
          <form onsubmit="savePrice(event)" id="priceForm">
            <input type="hidden" id="priceEditingId" value="">
            <div class="form-group">
              <label class="form-label">üßæ –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</label>
              <input type="text" class="form-input" id="priceTitle" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, FDM –ø–µ—á–∞—Ç—å">
            </div>
            <div class="form-group">
              <label class="form-label">üìÑ –û–ø–∏—Å–∞–Ω–∏–µ</label>
              <textarea class="form-textarea" id="priceDescription" placeholder="–î–µ—Ç–∞–ª–∏ —É—Å–ª—É–≥–∏"></textarea>
            </div>
            <div class="form-group" style="display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
              <div>
                <label class="form-label">üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å</label>
                <input type="number" class="form-input" id="priceValue" min="0" step="0.01" required placeholder="0">
              </div>
              <div>
                <label class="form-label">üìå –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è</label>
                <input type="text" class="form-input" id="priceUnit" placeholder="‚ÇΩ –∑–∞ –≥—Ä–∞–º–º">
              </div>
            </div>
            <div style="display:flex; gap:12px; flex-wrap: wrap;">
              <button type="submit" class="btn btn-primary" id="savePriceBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Å–ª—É–≥—É</button>
              <button type="button" class="btn btn-danger" onclick="cancelPriceEdit()" id="cancelPriceBtn" style="display:none;">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
          </form>

          <div>
            <h3 style="margin:0 0 16px;color:var(--primary)">–¢–µ–∫—É—â–∏–π –ø—Ä–∞–π—Å</h3>
            <div class="price-list-items" id="priceList"></div>
          </div>
        </div>
      </div>

      <div class="admin-pane" id="settingsPane">
        <div class="admin-settings">
          <h3>üåê GitHub —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</h3>
          <p>–î–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞ –±–µ—Ä—É—Ç—Å—è –∏–∑ <code>data/projects.json</code>. –£–∫–∞–∂–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Ç–æ–∫–µ–Ω, —á—Ç–æ–±—ã –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É –¥–ª—è –≤—Å–µ—Ö.</p>
          <div class="form-group">
            <label class="form-label" for="githubRepo">üìÅ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</label>
            <input type="text" class="form-input" id="githubRepo" placeholder="owner/repo">
          </div>
          <div class="form-group">
            <label class="form-label" for="githubToken">üîë Personal Access Token</label>
            <input type="password" class="form-input" id="githubToken" placeholder="ghp_‚Ä¶" autocomplete="off">
            <p class="form-hint">–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ. –ù—É–∂–Ω—ã –ø—Ä–∞–≤–∞ <code>repo</code> –∏–ª–∏ <code>public_repo</code>.</p>
          </div>
          <div class="settings-actions">
            <button type="button" class="btn btn-secondary" onclick="storage.syncFromGitHub()">‚¨áÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub</button>
            <button type="button" class="btn btn-secondary" onclick="storage.clearToken()">üßπ –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
          </div>
          <div class="sync-status" id="syncStatus" data-state="pending">GitHub: –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // –ö–æ–Ω—Ñ–∏–≥: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    // –ï—Å–ª–∏ ADMIN_PASSWORD –Ω–µ–ø—É—Å—Ç–æ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Ä–æ–ª—è –∫–∞–∫ –≤ (3).
    // –ï—Å–ª–∏ –ø—É—Å—Ç–æ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞, –∫–∞–∫ –≤ (2).
    const CONFIG = {
      MAX_IMAGES: 10,
      MAX_IMAGE_SIZE: 5 * 1024 * 1024, // 5MB
      ADMIN_HASH_KEY: '3d_admin_hash',
      ADMIN_PASSWORD: '3DStudio_SuperSecure_2025!@#$',
      GITHUB_OWNER: 'm3dkzn',
      GITHUB_REPO: 'm3dkzn.github.io',
      GITHUB_BRANCH: 'main',
      GITHUB_DATA_PATH: 'data/projects.json',
      TOKEN_STORAGE_KEY: '3d_studio_github_token',
      REPO_STORAGE_KEY: '3d_studio_repo'
    };

    const state = {
      projects: [],
      priceList: [],
      currentProject: null,
      currentImageIndex: 0,
      isAdminAuthenticated: false,
      editingProjectId: null,
      editingPriceId: null,
      uploadedFiles: [],
      githubToken: '',
      repoOwner: CONFIG.GITHUB_OWNER,
      repoName: CONFIG.GITHUB_REPO,
      remoteSha: null,
      isSyncing: false
    };

    // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
    const DEFAULT_PROJECTS = [
      { id: 1, name: '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã', description: '–í—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π SLA, SLS –∏ FDM.', images: ['https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop'], price: 2500 },
      { id: 2, name: '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –º–∞–∫–µ—Ç—ã', description: '–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∑–¥–∞–Ω–∏–π, —Ä–∞–π–æ–Ω–æ–≤ –∏ –ª–∞–Ω–¥—à–∞—Ñ—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.', images: ['https://images.unsplash.com/photo-1503387837-b154d5074bd2?w=800&h=600&fit=crop'], price: 15000 },
      { id: 3, name: '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –º–æ–¥–µ–ª–∏', description: '–ë–∏–æ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Ç–æ—á–Ω—ã—Ö –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π, —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤.', images: ['https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=800&h=600&fit=crop'], price: 8000 }
    ];

    const DEFAULT_PRICE_LIST = [
      { id: 1, title: 'FDM –ø–µ—á–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç', description: 'PLA / PETG, —Å–ª–æ–π 0.2 –º–º, –±–∞–∑–æ–≤–∞—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞', price: 25, unit: '‚ÇΩ –∑–∞ –≥—Ä–∞–º–º' },
      { id: 2, title: 'SLA –ø–µ—á–∞—Ç—å premium', description: '–§–æ—Ç–æ–ø–æ–ª–∏–º–µ—Ä, —Ç–æ—á–Ω–æ—Å—Ç—å –¥–æ 50 –º–∫–º, —Å–º–æ–ª–µ–Ω–∏–µ –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞', price: 45, unit: '‚ÇΩ –∑–∞ –≥—Ä–∞–º–º' },
      { id: 3, title: '3D-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –ø–µ—á–∞—Ç—å', description: '–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ —á–µ—Ä—Ç–µ–∂—É/—ç—Å–∫–∏–∑—É —Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π –∫ –ø–µ—á–∞—Ç–∏', price: 1500, unit: '‚ÇΩ –∑–∞ —á–∞—Å' }
    ];

    // –£—Ç–∏–ª–∏—Ç—ã
    const utils = {
      id: () => Date.now() + Math.random(),
      price: (p) => new Intl.NumberFormat('ru-RU').format(p),
      msg(text, type = 'success') {
        const el = document.createElement('div');
        el.className = `message ${type}`; el.textContent = text; document.body.appendChild(el);
        setTimeout(() => el.classList.add('show'), 50);
        setTimeout(() => { el.classList.remove('show'); setTimeout(() => el.remove(), 300) }, 2800);
      },
      trunc: (t, n) => t.length > n ? t.slice(0, n) + '‚Ä¶' : t,
      escape(text) {
        const map = {
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        };
        return String(text ?? '').replace(/[&<>"']/g, ch => map[ch] || ch);
      },
      async sha(text) {
        if (!window.crypto?.subtle) return `plain:${text}`;
        const enc = new TextEncoder().encode(text);
        const hash = await crypto.subtle.digest('SHA-256', enc);
        return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
      },
      decodeBase64(str) {
        try {
          if (window.TextDecoder) {
            return new TextDecoder().decode(Uint8Array.from(atob(str), c => c.charCodeAt(0)));
          }
        } catch (_) {}
        return decodeURIComponent(Array.from(atob(str)).map(c => `%${c.charCodeAt(0).toString(16).padStart(2, '0')}`).join(''));
      },
      encodeBase64(str) {
        return btoa(unescape(encodeURIComponent(str)));
      },
      validateImage(file) {
        if (!file.type.startsWith('image/')) throw new Error('–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º');
        if (file.size > CONFIG.MAX_IMAGE_SIZE) throw new Error('–†–∞–∑–º–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5 MB');
        return true;
      }
    };

    const dataHelpers = {
      cloneProjects(list) {
        if (!Array.isArray(list)) return [];
        return list.map(project => ({
          ...project,
          images: Array.isArray(project?.images)
            ? project.images.map(img => (typeof img === 'string' ? img : { ...img }))
            : []
        }));
      },
      clonePriceList(list) {
        if (!Array.isArray(list)) return [];
        return list.map(item => ({ ...item }));
      }
    };

    function applyPortfolioData(payload) {
      if (Array.isArray(payload)) {
        state.projects = dataHelpers.cloneProjects(payload);
        state.priceList = dataHelpers.clonePriceList(DEFAULT_PRICE_LIST);
        if (!state.projects.length) {
          state.projects = dataHelpers.cloneProjects(DEFAULT_PROJECTS);
        }
        return;
      }
      if (payload && typeof payload === 'object') {
        state.projects = dataHelpers.cloneProjects(payload.projects);
        state.priceList = dataHelpers.clonePriceList(payload.priceList?.length ? payload.priceList : DEFAULT_PRICE_LIST);
        if (!state.priceList.length) {
          state.priceList = dataHelpers.clonePriceList(DEFAULT_PRICE_LIST);
        }
        if (!state.projects.length) {
          state.projects = dataHelpers.cloneProjects(DEFAULT_PROJECTS);
        }
        return;
      }
      state.projects = dataHelpers.cloneProjects(DEFAULT_PROJECTS);
      state.priceList = dataHelpers.clonePriceList(DEFAULT_PRICE_LIST);
    }

    // –•—Ä–∞–Ω–∏–ª–∏—â–µ
    const storage = {
      async load() {
        try {
          await this.loadFromGitHub();
        } catch (err) {
          console.warn('GitHub load failed', err);
          if (!this.loadFromLocalCache()) {
            applyPortfolioData(DEFAULT_PROJECTS);
          }
          setSyncStatus('GitHub: –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–µ—à', 'error');
        }
      },
      loadFromLocalCache() {
        try {
          const cached = localStorage.getItem('3d_studio_projects_cache');
          if (cached) {
            const parsed = JSON.parse(cached);
            const payload = parsed?.data || parsed;
            applyPortfolioData(payload);
            state.remoteSha = parsed?.sha || null;
            return true;
          }
          const legacy = localStorage.getItem('3d_studio_projects');
          if (legacy) {
            const legacyData = JSON.parse(legacy);
            applyPortfolioData(legacyData);
            return true;
          }
        } catch (err) {
          console.warn('Local cache error', err);
        }
        return false;
      },
      saveToLocalCache() {
        try {
          localStorage.setItem('3d_studio_projects_cache', JSON.stringify({
            projects: state.projects,
            priceList: state.priceList,
            sha: state.remoteSha,
            updatedAt: Date.now()
          }));
        } catch (_) {}
      },
      async loadFromGitHub() {
        const apiUrl = `https://api.github.com/repos/${state.repoOwner}/${state.repoName}/contents/${CONFIG.GITHUB_DATA_PATH}?ref=${CONFIG.GITHUB_BRANCH}`;
        const response = await fetch(apiUrl, { headers: { 'Accept': 'application/vnd.github+json' }, cache: 'no-store' });
        if (!response.ok) {
          throw new Error(`GitHub –æ—Ç–≤–µ—Ç ${response.status}`);
        }
        const data = await response.json();
        if (!data.content) throw new Error('–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç GitHub');
        const decoded = utils.decodeBase64(data.content);
        const payload = JSON.parse(decoded);
        applyPortfolioData(payload);
        state.remoteSha = data.sha || null;
        this.saveToLocalCache();
        setSyncStatus('GitHub: –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'ok');
      },
      async save() {
        try {
          await this.saveToGitHub();
        } finally {
          this.saveToLocalCache();
        }
      },
      async saveToGitHub() {
        if (!state.githubToken) {
          throw new Error('GitHub —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.');
        }
        if (state.isSyncing) {
          throw new Error('–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å GitHub.');
        }
        state.isSyncing = true;
        setSyncStatus('GitHub: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è‚Ä¶', 'pending');
        try {
          const apiUrl = `https://api.github.com/repos/${state.repoOwner}/${state.repoName}/contents/${CONFIG.GITHUB_DATA_PATH}`;
          const payload = {
            message: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å —Å–∞–π—Ç–∞',
            content: utils.encodeBase64(JSON.stringify({
              projects: state.projects,
              priceList: state.priceList
            }, null, 2)),
            branch: CONFIG.GITHUB_BRANCH
          };
          if (state.remoteSha) payload.sha = state.remoteSha;
          const response = await fetch(apiUrl, {
            method: 'PUT',
            headers: {
              'Accept': 'application/vnd.github+json',
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${state.githubToken}`
            },
            body: JSON.stringify(payload)
          });
          if (!response.ok) {
            const errorBody = await response.json().catch(() => ({}));
            const errorMessage = errorBody.message || `GitHub –æ—Ç–≤–µ—Ç ${response.status}`;
            if (response.status === 409 || /sha/i.test(errorMessage) || /does not match/i.test(errorMessage)) {
              state.remoteSha = null;
              setSyncStatus('GitHub: –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ù–∞–∂–º–∏—Ç–µ ¬´–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub¬ª –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ.', 'error');
              throw new Error('GitHub: –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –û–±–Ω–æ–≤–∏—Ç–µ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.');
            }
            throw new Error(errorMessage);
          }
          const result = await response.json();
          state.remoteSha = result.content?.sha || state.remoteSha;
          utils.msg('–ò–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –Ω–∞ GitHub');
          setSyncStatus('GitHub: –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã', 'ok');
        } catch (err) {
          const message = typeof err?.message === 'string' && err.message.trim().startsWith('GitHub:')
            ? err.message.trim()
            : `GitHub: ${err?.message || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`;
          setSyncStatus(message, 'error');
          throw err;
        } finally {
          state.isSyncing = false;
        }
      },
      async syncFromGitHub() {
        if (state.isSyncing) {
          utils.msg('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø–æ–¥–æ–∂–¥–∏—Ç–µ‚Ä¶', 'error');
          return;
        }
        state.isSyncing = true;
        setSyncStatus('GitHub: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è‚Ä¶', 'pending');
        utils.msg('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ GitHub‚Ä¶');
        try {
          await this.loadFromGitHub();
          ui.loadProjects();
          ui.loadProjectList();
          ui.loadPriceList();
          ui.renderPriceAdminList();
          utils.msg('–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å GitHub');
          setSyncStatus('GitHub: –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'ok');
        } catch (err) {
          utils.msg('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ GitHub: ' + err.message, 'error');
          setSyncStatus('GitHub: ' + err.message, 'error');
        } finally {
          state.isSyncing = false;
        }
      },
      clearToken() {
        state.githubToken = '';
        sessionStorage.removeItem(CONFIG.TOKEN_STORAGE_KEY);
        localStorage.removeItem(CONFIG.TOKEN_STORAGE_KEY);
        const input = document.getElementById('githubToken');
        if (input) input.value = '';
        utils.msg('GitHub —Ç–æ–∫–µ–Ω —É–¥–∞–ª—ë–Ω');
        setSyncStatus('GitHub: —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω', 'error');
      }
    };

    function setSyncStatus(text, state = 'pending'){
      const indicator = document.getElementById('syncStatus');
      if (!indicator) return;
      indicator.textContent = text;
      indicator.dataset.state = state;
    }

    function initSyncSettings(){
      const repoInput = document.getElementById('githubRepo');
      const tokenInput = document.getElementById('githubToken');
      const storedRepo = localStorage.getItem(CONFIG.REPO_STORAGE_KEY);
      if (storedRepo) {
        const applied = setRepo(storedRepo, true);
        if (repoInput) repoInput.value = applied ? storedRepo : `${state.repoOwner}/${state.repoName}`;
      } else if (repoInput) {
        repoInput.value = `${state.repoOwner}/${state.repoName}`;
      }

      if (repoInput) {
        repoInput.addEventListener('change', () => setRepo(repoInput.value));
      }

      const storedToken = sessionStorage.getItem(CONFIG.TOKEN_STORAGE_KEY) || localStorage.getItem(CONFIG.TOKEN_STORAGE_KEY) || '';
      if (storedToken) {
        state.githubToken = storedToken;
        setSyncStatus('GitHub: —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω, –º–æ–∂–Ω–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è', 'pending');
      }
      if (tokenInput) {
        tokenInput.value = storedToken;
        if (!storedToken) {
          setSyncStatus('GitHub: —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω', 'error');
        }
        tokenInput.addEventListener('input', (e) => {
          state.githubToken = e.target.value.trim();
          if (state.githubToken) {
            sessionStorage.setItem(CONFIG.TOKEN_STORAGE_KEY, state.githubToken);
            localStorage.setItem(CONFIG.TOKEN_STORAGE_KEY, state.githubToken);
            setSyncStatus('GitHub: —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω, –º–æ–∂–Ω–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è', 'pending');
          } else {
            sessionStorage.removeItem(CONFIG.TOKEN_STORAGE_KEY);
            localStorage.removeItem(CONFIG.TOKEN_STORAGE_KEY);
            setSyncStatus('GitHub: —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω', 'error');
          }
        });
      }

      function setRepo(value, silent = false){
        const parts = value.split('/').map(p => p.trim()).filter(Boolean);
        if (parts.length === 2) {
          [state.repoOwner, state.repoName] = parts;
          localStorage.setItem(CONFIG.REPO_STORAGE_KEY, `${state.repoOwner}/${state.repoName}`);
          return true;
        } else if (!silent) {
          utils.msg('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç owner/repo –¥–ª—è GitHub', 'error');
          if (repoInput) repoInput.value = `${state.repoOwner}/${state.repoName}`;
        }
        return false;
      }
    }

    // –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    const imageHandler = {
      toBase64(file){ return new Promise((res, rej) => { const r = new FileReader(); r.onload = () => res(r.result); r.onerror = rej; r.readAsDataURL(file); }); },
      async process(files){ const out = []; for (const f of files){ try { utils.validateImage(f); out.push({ id: utils.id(), name: f.name, data: await this.toBase64(f) }); } catch(e){ utils.msg(`–û—à–∏–±–∫–∞ ${f.name}: ${e.message}`, 'error'); } } return out; }
    };

    const priceManager = {
      async create(data){
        const item = {
          id: utils.id(),
          title: data.title,
          description: data.description,
          price: parseFloat(data.price ?? 0) || 0,
          unit: data.unit || ''
        };
        state.priceList.push(item);
        try {
          await storage.save();
          ui.loadPriceList();
          ui.renderPriceAdminList();
          utils.msg('–£—Å–ª—É–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
          return item;
        } catch (err) {
          state.priceList.pop();
          storage.saveToLocalCache();
          throw err;
        }
      },
      async update(id, data){
        const index = state.priceList.findIndex(item => item.id === id);
        if (index < 0) throw new Error('–ó–∞–ø–∏—Å—å –ø—Ä–∞–π—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        const previous = { ...state.priceList[index] };
        state.priceList[index] = {
          ...state.priceList[index],
          title: data.title,
          description: data.description,
          price: parseFloat(data.price ?? 0) || 0,
          unit: data.unit || ''
        };
        try {
          await storage.save();
          ui.loadPriceList();
          ui.renderPriceAdminList();
          utils.msg('–ü–æ–∑–∏—Ü–∏—è –ø—Ä–∞–π—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
          return state.priceList[index];
        } catch (err) {
          state.priceList[index] = previous;
          storage.saveToLocalCache();
          throw err;
        }
      },
      async delete(id){
        const index = state.priceList.findIndex(item => item.id === id);
        if (index < 0) return;
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É –∏–∑ –ø—Ä–∞–π—Å–∞?')) return;
        const [removed] = state.priceList.splice(index, 1);
        try {
          await storage.save();
          ui.loadPriceList();
          ui.renderPriceAdminList();
          utils.msg('–ü–æ–∑–∏—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ø—Ä–∞–π—Å–∞');
        } catch (err) {
          if (removed) state.priceList.splice(index, 0, removed);
          storage.saveToLocalCache();
          utils.msg('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é: ' + err.message, 'error');
        }
      },
      async move(id, direction){
        const index = state.priceList.findIndex(item => item.id === id);
        if (index < 0) return;
        const targetIndex = index + direction;
        if (targetIndex < 0 || targetIndex >= state.priceList.length) return;
        const item = state.priceList.splice(index, 1)[0];
        state.priceList.splice(targetIndex, 0, item);
        try {
          await storage.save();
          ui.loadPriceList();
          ui.renderPriceAdminList();
        } catch (err) {
          state.priceList.splice(targetIndex, 1);
          state.priceList.splice(index, 0, item);
          storage.saveToLocalCache();
          utils.msg('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ—Ä—è–¥–∫–∞: ' + err.message, 'error');
        }
      },
      get: (id) => state.priceList.find(item => item.id === id)
    };

    // –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
    const projectManager = {
      async create(d){ 
        const p = { id: utils.id(), name: d.name, description: d.description, price: parseInt(d.price,10)||0, images: d.images||[], createdAt: new Date().toISOString() }; 
        state.projects.push(p); 
        try {
          await storage.save();
          ui.loadProjects(); ui.loadProjectList(); utils.msg('–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω');
          return p;
        } catch (err) {
          state.projects.pop();
          storage.saveToLocalCache();
          throw err;
        }
      },
      async update(id, d){ 
        const i = state.projects.findIndex(p=>p.id===id); if(i<0) throw new Error('–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω'); 
        const prev = { ...state.projects[i] };
        state.projects[i] = { ...state.projects[i], name:d.name, description:d.description, price: parseInt(d.price,10)||0, images: d.images?.length? d.images : state.projects[i].images, updatedAt: new Date().toISOString() }; 
        try {
          await storage.save();
          ui.loadProjects(); ui.loadProjectList(); utils.msg('–ü—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–ª—ë–Ω');
          return state.projects[i];
        } catch (err) {
          state.projects[i] = prev;
          storage.saveToLocalCache();
          throw err;
        }
      },
      async delete(id){ 
        const i = state.projects.findIndex(p=>p.id===id); if(i<0) return; 
        if(confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç?')){ 
          const removed = state.projects.splice(i,1)?.[0];
          try {
            await storage.save();
            ui.loadProjects(); ui.loadProjectList(); utils.msg('–ü—Ä–æ–µ–∫—Ç —É–¥–∞–ª—ë–Ω');
          } catch (err) {
            if (removed) state.projects.splice(i, 0, removed);
            storage.saveToLocalCache();
            utils.msg('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è: ' + err.message, 'error');
          }
        }
      },
      get: (id) => state.projects.find(p=>p.id===id)
    };

    // UI
    const ui = {
      loadProjects(){ 
        const grid = document.getElementById('projectsGrid'); grid.innerHTML=''; 
        state.projects.forEach(project=>{ 
          const card = document.createElement('div'); 
          card.className='project-card'; 
          card.onclick=()=>ui.openProject(project); 

          const imageWrapper = document.createElement('div');
          imageWrapper.className = 'project-image';
          const firstImage = project.images?.[0];
          const imageSrc = typeof firstImage === 'string' ? firstImage : firstImage?.data;
          if (imageSrc) {
            const imageEl = document.createElement('img');
            imageEl.src = imageSrc;
            imageEl.alt = project.name || '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞';
            imageEl.loading = 'lazy';
            imageWrapper.appendChild(imageEl);
          } else {
            imageWrapper.textContent = 'üì¶ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞';
          }
          card.appendChild(imageWrapper);

          const content = document.createElement('div');
          content.className = 'project-content';

          const title = document.createElement('h3');
          title.className = 'project-name';
          title.textContent = project.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
          content.appendChild(title);

          const description = document.createElement('p');
          description.className = 'project-description';
          description.textContent = utils.trunc(project.description || '', 120);
          content.appendChild(description);

          const price = document.createElement('div');
          price.className = 'project-price';
          price.textContent = `${utils.price(project.price)} ‚ÇΩ`;
          content.appendChild(price);

          card.appendChild(content);
          grid.appendChild(card); 
        }); 
      },
      loadPriceList(){
        const grid = document.getElementById('pricingGrid');
        if (!grid) return;
        grid.innerHTML = '';
        const list = state.priceList?.length ? state.priceList : DEFAULT_PRICE_LIST;
        list.forEach(item => {
          const card = document.createElement('div');
          card.className = 'price-card';

          const title = document.createElement('h3');
          title.textContent = item.title || '–£—Å–ª—É–≥–∞';
          card.appendChild(title);

          if (item.description) {
            const desc = document.createElement('p');
            desc.textContent = item.description;
            card.appendChild(desc);
          }

          const priceRow = document.createElement('div');
          priceRow.className = 'price-row';
          const value = document.createElement('span');
          value.className = 'price-value';
          value.textContent = utils.price(item.price || 0);
          priceRow.appendChild(value);

          const unit = document.createElement('span');
          unit.className = 'price-unit';
          unit.textContent = item.unit || '‚ÇΩ';
          priceRow.appendChild(unit);

          card.appendChild(priceRow);
          grid.appendChild(card);
        });
      },
      renderPriceAdminList(){
        const container = document.getElementById('priceList');
        if (!container) return;
        container.innerHTML = '';
        const list = state.priceList;
        if (!list.length){
          const empty = document.createElement('p');
          empty.style.color = 'var(--gray)';
          empty.style.textAlign = 'center';
          empty.textContent = '–î–æ–±–∞–≤—å—Ç–µ —É—Å–ª—É–≥–∏, —á—Ç–æ–±—ã –ø—Ä–∞–π—Å –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–∞–π—Ç–µ';
          container.appendChild(empty);
          return;
        }
        list.forEach((item, index) => {
          const block = document.createElement('div');
          block.className = 'price-list-item';

          const header = document.createElement('header');
          const title = document.createElement('h4');
          title.textContent = item.title || '–£—Å–ª—É–≥–∞';
          header.appendChild(title);

          const amount = document.createElement('div');
          amount.className = 'price-value';
          amount.style.fontSize = '1.1rem';
          amount.textContent = `${utils.price(item.price || 0)} ${item.unit || '‚ÇΩ'}`;
          header.appendChild(amount);

          block.appendChild(header);

          if (item.description) {
            const desc = document.createElement('p');
            desc.textContent = item.description;
            block.appendChild(desc);
          }

          const controls = document.createElement('div');
          controls.className = 'price-controls';

          const editBtn = document.createElement('button');
          editBtn.className = 'btn-light';
          editBtn.type = 'button';
          editBtn.textContent = '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';
          editBtn.addEventListener('click', () => ui.editPrice(item.id));
          controls.appendChild(editBtn);

          const deleteBtn = document.createElement('button');
          deleteBtn.className = 'btn-danger';
          deleteBtn.type = 'button';
          deleteBtn.textContent = 'üóëÔ∏è –£–¥–∞–ª–∏—Ç—å';
          deleteBtn.addEventListener('click', () => priceManager.delete(item.id));
          controls.appendChild(deleteBtn);

          const moveUp = document.createElement('button');
          moveUp.className = 'btn-light';
          moveUp.type = 'button';
          moveUp.textContent = '‚¨ÜÔ∏è';
          moveUp.disabled = index === 0;
          moveUp.addEventListener('click', () => priceManager.move(item.id, -1));
          controls.appendChild(moveUp);

          const moveDown = document.createElement('button');
          moveDown.className = 'btn-light';
          moveDown.type = 'button';
          moveDown.textContent = '‚¨áÔ∏è';
          moveDown.disabled = index === list.length - 1;
          moveDown.addEventListener('click', () => priceManager.move(item.id, 1));
          controls.appendChild(moveDown);

          block.appendChild(controls);
          container.appendChild(block);
        });
      },
      editPrice(id){
        const item = priceManager.get(id);
        if (!item) return;
        state.editingPriceId = id;
        const form = document.getElementById('priceForm');
        if (!form) return;
        document.getElementById('priceEditingId').value = id;
        document.getElementById('priceTitle').value = item.title || '';
        document.getElementById('priceDescription').value = item.description || '';
        document.getElementById('priceValue').value = item.price ?? '';
        document.getElementById('priceUnit').value = item.unit || '';
        document.getElementById('savePriceBtn').textContent = 'üíæ –û–±–Ω–æ–≤–∏—Ç—å —É—Å–ª—É–≥—É';
        document.getElementById('cancelPriceBtn').style.display = 'inline-block';
        switchAdminPane('pricing');
        utils.msg('–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–π—Å–∞');
      },
      openProject(project){
        state.currentProject = project;
        state.currentImageIndex = 0;
        document.getElementById('modalTitle').textContent = project.name;
        document.getElementById('modalDescription').textContent = project.description;
        document.getElementById('projectPrice').textContent = utils.price(project.price);
        this.updateModalImage();
        this.updateImageNavigation();
        document.getElementById('projectModal').classList.add('show');
      },
      closeProject(){ document.getElementById('projectModal').classList.remove('show'); state.currentProject=null; },
      updateModalImage(){
        const modalImage = document.getElementById('modalImage');
        if (!modalImage) return;
        modalImage.innerHTML = '';
        modalImage.classList.remove('empty');
        const p = state.currentProject;
        if(!p){ return; }
        const imgs = Array.isArray(p.images) ? p.images : [];
        if(!imgs.length){
          modalImage.textContent = '–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π';
          modalImage.classList.add('empty');
          return;
        }
        const current = imgs[state.currentImageIndex];
        const url = typeof current === 'string' ? current : current?.data;
        if (!url) {
          modalImage.textContent = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
          modalImage.classList.add('empty');
          return;
        }
        const imageEl = document.createElement('img');
        imageEl.src = url;
        imageEl.alt = p.name || '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞';
        modalImage.appendChild(imageEl);
      },
      updateImageNavigation(){
        const p = state.currentProject; const prevBtn = document.getElementById('prevBtn'); const nextBtn = document.getElementById('nextBtn'); const counter = document.getElementById('imageCounter');
        const imgs = p?.images || [];
        if(imgs.length <= 1){ prevBtn.style.display='none'; nextBtn.style.display='none'; counter.textContent='1 / 1'; return; }
        prevBtn.style.display='flex'; nextBtn.style.display='flex'; counter.textContent = `${state.currentImageIndex + 1} / ${imgs.length}`;
        prevBtn.disabled = state.currentImageIndex === 0;
        nextBtn.disabled = state.currentImageIndex === imgs.length - 1;
      },
      loadProjectList(){ 
        const list = document.getElementById('projectList'); if(!list) return; list.innerHTML=''; 
        if(!state.projects.length){ list.innerHTML='<p style="color:var(--gray);text-align:center">–ü—Ä–æ–µ–∫—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>'; return; }
        state.projects.forEach(p=>{ 
          const div = document.createElement('div'); 
          div.className='project-item'; 
          const img = p.images?.[0] ? (typeof p.images[0]==='string'? p.images[0] : p.images[0].data) : '';
          div.innerHTML = `
            <h4>${p.name}</h4>
            <p>${utils.trunc(p.description, 160)}</p>
            <div class="project-actions">
              <button class="btn-success" onclick="ui.editProject(${JSON.stringify(p.id)})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
              <button class="btn-danger" onclick="projectManager.delete(${JSON.stringify(p.id)})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
            </div>`;
          list.appendChild(div); 
        }); 
      },
      editProject(id){
        const project = projectManager.get(id); if(!project) return;
        state.editingProjectId = id;
        document.getElementById('editingId').value = id;
        document.getElementById('projectName').value = project.name;
        document.getElementById('projectDescription').value = project.description;
        document.getElementById('projectPriceInput').value = project.price;
        // –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É
        state.uploadedFiles = (project.images||[]).map((img, i)=>({ id: `existing_${i}`, data: typeof img==='string'? img : img.data, name: typeof img==='string'? `image_${i}.jpg` : img.name }));
        ui.updateUploadedImages();
        switchAdminPane('projects');
        switchProjectTab('add');
        document.getElementById('saveBtn').textContent = 'üíæ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç';
        document.getElementById('cancelBtn').style.display = 'inline-block';
        utils.msg('–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
      },
      updateUploadedImages(){ 
        const container = document.getElementById('uploadedImages'); if(!container) return; container.innerHTML=''; 
        if(!state.uploadedFiles.length){
          const placeholder = document.createElement('p');
          placeholder.style.color = 'var(--gray)';
          placeholder.style.fontSize = '0.9rem';
          placeholder.textContent = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã';
          container.appendChild(placeholder);
          return;
        }
        state.uploadedFiles.forEach((file, index)=>{ 
          const wrapper=document.createElement('div'); wrapper.className='uploaded-image';

          const img=document.createElement('img');
          img.src=file.data;
          img.alt=file.name || `–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${index+1}`;
          wrapper.appendChild(img);

          const removeBtn=document.createElement('button');
          removeBtn.className='remove-image';
          removeBtn.type='button';
          removeBtn.innerHTML='√ó';
          removeBtn.addEventListener('click', ()=> ui.removeUploadedImage(index));
          wrapper.appendChild(removeBtn);

          if (state.uploadedFiles.length > 1){
            const reorder = document.createElement('div');
            reorder.className = 'reorder-group';

            const upBtn = document.createElement('button');
            upBtn.className = 'reorder-image';
            upBtn.type = 'button';
            upBtn.textContent = '‚Üë';
            upBtn.disabled = index === 0;
            upBtn.addEventListener('click', ()=> ui.moveUploadedImage(index, -1));
            reorder.appendChild(upBtn);

            const downBtn = document.createElement('button');
            downBtn.className = 'reorder-image';
            downBtn.type = 'button';
            downBtn.textContent = '‚Üì';
            downBtn.disabled = index === state.uploadedFiles.length - 1;
            downBtn.addEventListener('click', ()=> ui.moveUploadedImage(index, 1));
            reorder.appendChild(downBtn);

            wrapper.appendChild(reorder);
          }

          container.appendChild(wrapper); 
        }); 
      },
      moveUploadedImage(index, direction){
        const targetIndex = index + direction;
        if (targetIndex < 0 || targetIndex >= state.uploadedFiles.length) return;
        const [item] = state.uploadedFiles.splice(index, 1);
        state.uploadedFiles.splice(targetIndex, 0, item);
        ui.updateUploadedImages();
      },
      removeUploadedImage(i){ state.uploadedFiles.splice(i,1); ui.updateUploadedImages(); }
    };

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–æ–¥–∞–ª–∫–µ
    function prevImage(){ if(state.currentProject && state.currentImageIndex>0){ state.currentImageIndex--; ui.updateModalImage(); ui.updateImageNavigation(); } }
    function nextImage(){ const p=state.currentProject; if(p && state.currentImageIndex < (p.images?.length||1)-1){ state.currentImageIndex++; ui.updateModalImage(); ui.updateImageNavigation(); } }
    function closeProject(){ ui.closeProject(); }

    // –ü–ª–∞–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∏ —Ä–µ–∞–∫—Ü–∏—è —à–∞–ø–∫–∏
    function initNavigation(){
      const menuToggle = document.getElementById('menuToggle');
      const navMenu = document.getElementById('navMenu');
      const closeMenu = () => {
        if (navMenu) navMenu.classList.remove('open');
        if (menuToggle) {
          menuToggle.setAttribute('aria-expanded', 'false');
          menuToggle.textContent = '‚ò∞';
        }
      };

      if (menuToggle && navMenu) {
        menuToggle.setAttribute('aria-expanded', 'false');
        menuToggle.addEventListener('click', (event) => {
          event.stopPropagation();
          const isOpen = navMenu.classList.toggle('open');
          menuToggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          menuToggle.textContent = isOpen ? '√ó' : '‚ò∞';
        });
      }

      document.addEventListener('click', (event) => {
        if (!navMenu || !menuToggle) return;
        if (!navMenu.classList.contains('open')) return;
        if (navMenu.contains(event.target) || event.target === menuToggle) return;
        closeMenu();
      });

      window.addEventListener('resize', () => {
        if (window.innerWidth > 768) closeMenu();
      });

      window.addEventListener('scroll', ()=> { 
        if (window.scrollY > 80) document.getElementById('navbar').classList.add('scrolled'); 
        else document.getElementById('navbar').classList.remove('scrolled'); 
      });
      document.querySelectorAll('a[href^="#"]').forEach(a=>{ 
        a.addEventListener('click',e=>{ 
          e.preventDefault(); 
          const t=document.querySelector(a.getAttribute('href')); 
          if(!t) return; 
          const top=t.getBoundingClientRect().top + window.scrollY - 80; 
          window.scrollTo({ top, behavior: 'smooth' }); 
          closeMenu();
        }); 
      });
    }

    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ö–µ–º –∏–∑ (3) –∏ (2))
    async function openAuth(){ const m=document.getElementById('authModal'); m.style.display='flex'; document.getElementById('adminPassword').focus(); }
    function closeAuth(){ document.getElementById('authModal').style.display='none'; }

    async function checkPassword(){
      const input = document.getElementById('adminPassword');
      const val = input.value || '';
      if (CONFIG.ADMIN_PASSWORD) {
        // –∫–∞–∫ –≤ (3): —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å
        if (val === CONFIG.ADMIN_PASSWORD) {
          state.isAdminAuthenticated = true; closeAuth(); openAdmin(); utils.msg('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å');
        } else { utils.msg('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error'); }
        input.value='';
        return;
      }
      // –∫–∞–∫ –≤ (2): –ø–µ—Ä–≤—ã–π –≤–≤–æ–¥ –∑–∞–¥–∞—ë—Ç –ø–∞—Ä–æ–ª—å (—Ö—Ä–∞–Ω–∏—Ç—Å—è —Ö–µ—à)
      const saved = localStorage.getItem(CONFIG.ADMIN_HASH_KEY); 
      const h = await utils.sha(val);
      if (!saved){ 
        localStorage.setItem(CONFIG.ADMIN_HASH_KEY, h); 
        state.isAdminAuthenticated = true; closeAuth(); openAdmin(); utils.msg('–ü–∞—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!'); 
      } else if (saved === h){ 
        state.isAdminAuthenticated = true; closeAuth(); openAdmin(); utils.msg('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å'); 
      } else { utils.msg('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error'); }
      input.value = '';
    }

    function openAdmin(){
      if (!state.isAdminAuthenticated) return openAuth();
      const panel = document.getElementById('adminPanel');
      if (panel) panel.classList.add('active');
      ui.loadProjectList();
      ui.renderPriceAdminList();
      switchAdminPane('projects');
      switchProjectTab('manage');
    }
    function closeAdmin(){
      const panel = document.getElementById('adminPanel');
      if (panel) panel.classList.remove('active');
      cancelEdit();
      cancelPriceEdit();
    }

    function switchAdminPane(pane){
      const paneMap = { projects: 'projectsPane', pricing: 'pricingPane', settings: 'settingsPane' };
      const tabMap = { projects: 'adminTabProjects', pricing: 'adminTabPricing', settings: 'adminTabSettings' };
      const targetId = paneMap[pane] || paneMap.projects;
      const targetTabId = tabMap[pane] || tabMap.projects;
      document.querySelectorAll('.admin-nav-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.admin-pane').forEach(el => el.classList.remove('active'));
      const paneEl = document.getElementById(targetId);
      if (paneEl) paneEl.classList.add('active');
      const tabEl = document.getElementById(targetTabId);
      if (tabEl) tabEl.classList.add('active');
      if (targetId === 'projectsPane') ui.loadProjectList();
      if (targetId === 'pricingPane') ui.renderPriceAdminList();
    }

    function switchProjectTab(tab) {
      const tabs = document.querySelectorAll('.project-tab');
      const panes = document.querySelectorAll('.project-tab-content');
      tabs.forEach(btn => btn.classList.remove('active'));
      panes.forEach(pane => pane.classList.remove('active'));
      if (tab === 'manage') {
        document.getElementById('projectTabManage')?.classList.add('active');
        document.getElementById('manageTab')?.classList.add('active');
        ui.loadProjectList();
      } else {
        document.getElementById('projectTabAdd')?.classList.add('active');
        document.getElementById('addTab')?.classList.add('active');
      }
    }

    async function saveProject(e){ 
      e.preventDefault(); 
      try{ 
        const data = { 
          name: document.getElementById('projectName').value, 
          description: document.getElementById('projectDescription').value, 
          price: document.getElementById('projectPriceInput').value, 
          images: state.uploadedFiles.map(f=>f.data) 
        };
        const id = document.getElementById('editingId').value; 
        if (id) await projectManager.update(parseInt(id,10), data); 
        else await projectManager.create(data); 
        cancelEdit(); 
      } catch(err){ utils.msg('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + err.message, 'error'); } 
    }

    async function savePrice(e){
      e.preventDefault();
      const form = document.getElementById('priceForm');
      if (!form) return;
      const data = {
        title: document.getElementById('priceTitle').value,
        description: document.getElementById('priceDescription').value,
        price: document.getElementById('priceValue').value,
        unit: document.getElementById('priceUnit').value
      };
      const idValue = document.getElementById('priceEditingId').value;
      const id = idValue ? Number(idValue) : null;
      try {
        if (id) {
          await priceManager.update(id, data);
        } else {
          await priceManager.create(data);
        }
        cancelPriceEdit();
      } catch (err) {
        utils.msg('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∞–π—Å–∞: ' + err.message, 'error');
        if (typeof err?.message === 'string' && err.message.includes('–¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å')) {
          storage.syncFromGitHub();
        }
      }
    }

    function cancelEdit(){ 
      state.editingProjectId=null; 
      state.uploadedFiles=[]; 
      const form=document.getElementById('projectForm'); if(form) form.reset(); 
      document.getElementById('editingId').value=''; 
      const saveBtn=document.getElementById('saveBtn'); if(saveBtn) saveBtn.textContent='‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç'; 
      const cancelBtn=document.getElementById('cancelBtn'); if(cancelBtn) cancelBtn.style.display='none'; 
      ui.updateUploadedImages(); 
      switchProjectTab('add');
    }

    function cancelPriceEdit(){
      state.editingPriceId = null;
      const form = document.getElementById('priceForm'); if (form) form.reset();
      document.getElementById('priceEditingId').value = '';
      const saveBtn = document.getElementById('savePriceBtn'); if (saveBtn) saveBtn.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Å–ª—É–≥—É';
      const cancelBtn = document.getElementById('cancelPriceBtn'); if (cancelBtn) cancelBtn.style.display = 'none';
    }

    function initDragAndDrop(){ 
      const area = document.getElementById('imageUploadArea'); 
      const input = document.getElementById('imageInput'); 
      if(!area||!input) return;
      area.addEventListener('click', ()=> input.click());
      input.addEventListener('change', async e=>{ const files=[...e.target.files]; await handleFiles(files); input.value=''; });
      ['dragenter','dragover','dragleave','drop'].forEach(n=>{ area.addEventListener(n, e=>{ e.preventDefault(); e.stopPropagation(); }); });
      ['dragenter','dragover'].forEach(n=> area.addEventListener(n, ()=> area.classList.add('dragover')));
      ['dragleave','drop'].forEach(n=> area.addEventListener(n, ()=> area.classList.remove('dragover')));
      area.addEventListener('drop', async e=>{ const files=[...e.dataTransfer.files]; await handleFiles(files); });
      async function handleFiles(files){ 
        if(state.uploadedFiles.length + files.length > CONFIG.MAX_IMAGES){ utils.msg(`–ú–∞–∫—Å–∏–º—É–º ${CONFIG.MAX_IMAGES} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`, 'error'); return; } 
        const processed = await imageHandler.process(files); 
        state.uploadedFiles.push(...processed); 
        ui.updateUploadedImages(); 
        if(processed.length) utils.msg(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${processed.length} –∏–∑–æ–±—Ä–∞–∂.`); 
      }
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ auth –ø–æ ?admin=true ‚Äî –∏–∑ (3)
    function checkAdminAccess(){ const urlParams = new URLSearchParams(window.location.search); if (urlParams.get('admin') === 'true') { openAuth(); } }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', async ()=>{
      initNavigation();
      initDragAndDrop();
      initSyncSettings();
      try {
        await storage.load();
      } catch (err) {
        utils.msg('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ GitHub: ' + err.message, 'error');
      }
      ui.loadProjects();
      ui.loadPriceList();
      ui.renderPriceAdminList();
      checkAdminAccess();

      // –®–æ—Ä—Ç–∫–∞—Ç –∫–∞–∫ –≤ (2)
      document.addEventListener('keydown', e=>{
        if(e.key==='Escape'){ ui.closeProject(); closeAuth(); closeAdmin(); }
        if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='a'){ e.preventDefault(); openAdmin(); }
      });

      utils.msg('üöÄ –°–∞–π—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
    });

    // –≠–∫—Å–ø–æ—Ä—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å
    window.prevImage = prevImage;
    window.nextImage = nextImage;
    window.closeProject = closeProject;
    window.checkPassword = checkPassword;
    window.closeAuth = closeAuth;
    window.openAdmin = openAdmin;
    window.closeAdmin = closeAdmin;
    window.switchAdminPane = switchAdminPane;
    window.switchProjectTab = switchProjectTab;
    window.cancelEdit = cancelEdit;
    window.saveProject = saveProject;
    window.savePrice = savePrice;
    window.cancelPriceEdit = cancelPriceEdit;
    window.ui = ui;
    window.projectManager = projectManager;
    window.priceManager = priceManager;
  </script>
</body>
</html>
